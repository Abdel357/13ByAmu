{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { FormControl, FormGroup, Validators } from \"@angular/forms\";\nlet ProfileComponent = class ProfileComponent {\n  constructor(profileService, router, connectionService, toastr) {\n    this.profileService = profileService;\n    this.router = router;\n    this.connectionService = connectionService;\n    this.toastr = toastr;\n    this.profileForm = new FormGroup({\n      firstName: new FormControl(\"\", Validators.required),\n      lastName: new FormControl(\"\", Validators.required),\n      picture: new FormControl(\"\", Validators.required),\n      address: new FormControl(\"\", Validators.required),\n      phoneNumber: new FormControl(\"\", [Validators.required, Validators.pattern(/^0[0-9]{9}$/) // format du numéro de téléphone (10 chiffres commençant par 0)\n      ]),\n\n      level: new FormControl(\"\", Validators.required),\n      sport: new FormControl(\"\", Validators.required),\n      gender: new FormControl(\"\", Validators.required),\n      photo: new FormControl(\"\", Validators.required)\n    });\n    this.selectedFile = null;\n    this.previewImage = null;\n  }\n  ngOnInit() {\n    this.connectionService.isUserLoggedIn$.subscribe(loggedIn => this.isLoggedIn = loggedIn);\n    if (this.isLoggedIn == false) {\n      this.router.navigate([\"/accueil\"]);\n    }\n    this.profileService.getUserProfile().subscribe(user => {\n      console.log(user);\n      this.profileForm.patchValue({\n        firstName: user.firstName || \"\",\n        lastName: user.lastName || \"\",\n        address: user.address || \"\",\n        phoneNumber: user.phoneNumber || \"\",\n        level: user.level || \"\",\n        sport: user.sport || \"\",\n        gender: user.gender || \"\",\n        photo: user.photo || \"\"\n      });\n    }, error => {\n      console.log(\"Error fetching user profile:\", error);\n    });\n  }\n  submit() {\n    if (this.profileForm.controls[\"phoneNumber\"].errors) {\n      this.toastr.warning(\"Format du numéro de téléphone invalide : <br> \" + \"10 chiffres commençant par 0<br>\", \"\", {\n        enableHtml: true\n      });\n      return;\n    }\n    const value = this.profileForm.value;\n    this.profileService.editProfile(value).subscribe(res => {\n      if (res.success) {\n        this.router.navigate([res.redirectUrl]);\n        this.toastr.success(\"modification réussie !\", \"Succès\");\n      }\n    });\n  }\n  onFileSelected(event) {\n    const file = event.target.files[0];\n    if (file) {\n      this.selectedFile = file;\n      const reader = new FileReader();\n      reader.onload = e => {\n        this.previewImage = e.target.result;\n      };\n      reader.readAsDataURL(this.selectedFile);\n      this.profileForm.patchValue({\n        picture: file\n      });\n    }\n  }\n  restrictToNumbers(event) {\n    const input = event.target;\n    input.value = input.value.replace(/[^0-9]/g, \"\");\n  }\n};\nProfileComponent = __decorate([Component({\n  selector: \"app-profile\",\n  templateUrl: \"./profile.component.html\",\n  styleUrls: [\"./profile.component.css\"]\n})], ProfileComponent);\nexport { ProfileComponent };","map":{"version":3,"names":["Component","FormControl","FormGroup","Validators","ProfileComponent","constructor","profileService","router","connectionService","toastr","profileForm","firstName","required","lastName","picture","address","phoneNumber","pattern","level","sport","gender","photo","selectedFile","previewImage","ngOnInit","isUserLoggedIn$","subscribe","loggedIn","isLoggedIn","navigate","getUserProfile","user","console","log","patchValue","error","submit","controls","errors","warning","enableHtml","value","editProfile","res","success","redirectUrl","onFileSelected","event","file","target","files","reader","FileReader","onload","e","result","readAsDataURL","restrictToNumbers","input","replace","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\Youssef EL-HAMRANI\\Desktop\\Node js\\NEW PFE\\project_pfe-frontend\\frontend\\src\\app\\components\\profile\\profile.component.ts"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\nimport { FormControl, FormGroup, Validators } from \"@angular/forms\";\nimport { ProfileService } from \"src/app/services/profile.service\";\nimport { Router } from \"@angular/router\";\nimport { ConnectionService } from \"src/app/services/connection.service\";\nimport { ToastrService } from \"ngx-toastr\";\n\n@Component({\n  selector: \"app-profile\",\n  templateUrl: \"./profile.component.html\",\n  styleUrls: [\"./profile.component.css\"],\n})\nexport class ProfileComponent implements OnInit {\n  isLoggedIn!: boolean;\n\n  profileForm: FormGroup = new FormGroup({\n    firstName: new FormControl(\"\", Validators.required),\n    lastName: new FormControl(\"\", Validators.required),\n    picture: new FormControl(\"\", Validators.required),\n    address: new FormControl(\"\", Validators.required),\n    phoneNumber: new FormControl(\"\", [\n      Validators.required,\n      Validators.pattern(/^0[0-9]{9}$/), // format du numéro de téléphone (10 chiffres commençant par 0)\n    ]),\n    level: new FormControl(\"\", Validators.required),\n    sport: new FormControl(\"\", Validators.required),\n    gender: new FormControl(\"\", Validators.required),\n    photo: new FormControl(\"\", Validators.required),\n  });\n\n  constructor(\n    private profileService: ProfileService,\n    private router: Router,\n    private connectionService: ConnectionService,\n    private toastr: ToastrService\n  ) {}\n\n  photoname!: string;\n\n  ngOnInit(): void {\n    this.connectionService.isUserLoggedIn$.subscribe(\n      (loggedIn) => (this.isLoggedIn = loggedIn)\n    );\n\n    if (this.isLoggedIn == false) {\n      this.router.navigate([\"/accueil\"]);\n    }\n\n    this.profileService.getUserProfile().subscribe(\n      (user) => {\n        console.log(user);\n        this.profileForm.patchValue({\n          firstName: user.firstName || \"\",\n          lastName: user.lastName || \"\",\n          address: user.address || \"\",\n          phoneNumber: user.phoneNumber || \"\",\n          level: user.level || \"\",\n          sport: user.sport || \"\",\n          gender: user.gender || \"\",\n          photo: user.photo || \"\",\n        });\n      },\n\n      (error) => {\n        console.log(\"Error fetching user profile:\", error);\n      }\n    );\n  }\n\n  submit() {\n    if (this.profileForm.controls[\"phoneNumber\"].errors) {\n      this.toastr.warning(\n        \"Format du numéro de téléphone invalide : <br> \" +\n          \"10 chiffres commençant par 0<br>\",\n        \"\",\n        { enableHtml: true }\n      );\n      return;\n    }\n    const value = this.profileForm.value;\n    this.profileService.editProfile(value).subscribe((res) => {\n      if (res.success) {\n        this.router.navigate([res.redirectUrl]);\n        this.toastr.success(\"modification réussie !\", \"Succès\");\n      }\n    });\n  }\n\n  selectedFile: File | null = null;\n  previewImage: string | null = null;\n\n  onFileSelected(event: any): void {\n    const file: File = event.target.files[0];\n\n    if (file) {\n      this.selectedFile = file;\n\n      const reader = new FileReader();\n      reader.onload = (e: any) => {\n        this.previewImage = e.target.result;\n      };\n      reader.readAsDataURL(this.selectedFile);\n\n      this.profileForm.patchValue({\n        picture: file,\n      });\n    }\n  }\n\n  restrictToNumbers(event: Event): void {\n    const input = event.target as HTMLInputElement;\n    input.value = input.value.replace(/[^0-9]/g, \"\");\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}